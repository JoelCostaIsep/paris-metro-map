#C_FLAGS = -Wall -g -std=c99
C_FLAGS = -Wall -g
LD_FLAGS = -lm
SRC = $(wildcard *.c)
OBJ = $(SRC:.c=.o)
CC = gcc
all : depend test_sta test_ligne test_connexion #test_dijkstra

depend : $(SRC)
	$(CC) -MM $^ > .depend

-include .depend

%.o: %.c
	$(CC) $(C_FLAGS) -c $<

#test_sta : test_sta.o liste.o truc.o abr.o station.o
test_sta : depend test_sta.o liste.o truc.o abr.o ligne.o
#	gcc ${C_FLAGS} -o test_sta test_sta.o truc.o liste.o abr.o station.o
	$(CC) $(C_FLAGS) -o test_sta test_sta.o truc.o liste.o abr.o ligne.o $(LD_FLAGS)

test_ligne : depend test_ligne.o ligne.o
	$(CC) $(C_FLAGS) -o test_ligne test_ligne.o ligne.o


#test_connexion : test_connexion.o connexion.o ligne.o abr.o liste.o truc.o station.o
#	gcc ${C_FLAGS} -lm -o test_connexion test_connexion.o connexion.o ligne.o abr.o liste.o truc.o station.o

test_connexion : depend test_connexion.o ligne.o abr.o liste.o truc.o
	$(CC) $(C_FLAGS) -o test_connexion test_connexion.o ligne.o abr.o liste.o truc.o $(LD_FLAGS)

test_dijkstra : depend test_dijkstra.o connexion.o ligne.o abr.o liste.o truc.o station.o dijkstra.o
	$(CC) $(C_FLAGS) -o test_dijkstra test_dijkstra.o connexion.o ligne.o abr.o liste.o truc.o station.o dijkstra.o $(LD_FLAGS)

metro_v0.o : metro_v0.c
	gcc ${C_FLAGS} -c metro_v0.c `pkg-config --cflags gtk+-2.0`

metro_callback_v0.o : metro_callback_v0.c
	gcc ${C_FLAGS} -c metro_callback_v0.c `pkg-config --cflags gtk+-2.0`

metro_v0 : depend metro_v0.o metro_callback_v0.o ligne.o abr.o liste.o truc.o
	gcc ${C_FLAGS} -o metro_v0 $^ `pkg-config --libs gtk+-2.0`

clean :
	rm -f $(OBJ) test_sta test_ligne test_connexion test_dijksra metro_v0 .depend

.PHONY: all clean depend